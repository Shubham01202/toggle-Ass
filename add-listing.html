<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Add/Edit Gadget Listing - GadgetStore</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">GadgetStore</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav" id="auth-buttons"></ul>
      </div>
    </div>
  </nav>

  <main class="container my-5" style="max-width: 600px;">
    <h2 class="mb-4 text-center" id="formTitle">Add Gadget Listing</h2>
    <form id="listingForm" novalidate>
      <div class="mb-3">
        <label for="brand" class="form-label">Brand</label>
        <input
          type="text"
          class="form-control"
          id="brand"
          placeholder="e.g. Apple, Dell"
          required
        />
        <div class="invalid-feedback">Brand is required.</div>
      </div>

      <div class="mb-3">
        <label for="model" class="form-label">Model</label>
        <input
          type="text"
          class="form-control"
          id="model"
          placeholder="Model name or number"
          required
        />
        <div class="invalid-feedback">Model is required.</div>
      </div>

      <div class="mb-3">
        <label for="price" class="form-label">Price (USD)</label>
        <input
          type="number"
          class="form-control"
          id="price"
          min="1"
          step="0.01"
          placeholder="Enter price"
          required
        />
        <div class="invalid-feedback">Valid price is required.</div>
      </div>

      <div class="mb-3">
        <label for="processor" class="form-label">Processor</label>
        <input
          type="text"
          class="form-control"
          id="processor"
          placeholder="e.g. Intel i7"
          required
        />
        <div class="invalid-feedback">Processor is required.</div>
      </div>

      <div class="mb-3">
        <label for="battery" class="form-label">Battery Life</label>
        <input
          type="text"
          class="form-control"
          id="battery"
          placeholder="e.g. 8 hours"
          required
        />
        <div class="invalid-feedback">Battery info is required.</div>
      </div>

      <div class="mb-3">
        <label class="form-label d-block">Category</label>
        <select class="form-select" id="category" required>
          <option value="" selected disabled>Choose category</option>
          <option value="Windows">Windows</option>
          <option value="MacBook">MacBook</option>
          <option value="MacBook">Smart-watch</option>
          <option value="MacBook">Earbuds</option>
        </select>
        <div class="invalid-feedback">Please select a category.</div>
      </div>

      <div class="mb-3">
        <label class="form-label d-block">Condition</label>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            name="condition"
            id="conditionNew"
            value="New"
            required
          />
          <label class="form-check-label" for="conditionNew">New</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            name="condition"
            id="conditionOld"
            value="Old"
            required
          />
          <label class="form-check-label" for="conditionOld">Old</label>
        </div>
        <div class="invalid-feedback d-block" id="conditionError">
          Please select a condition.
        </div>
      </div>

      <div class="mb-3">
        <label for="image" class="form-label">Upload Image</label>
        <input
          class="form-control"
          type="file"
          id="image"
          accept="image/*"
          required
        />
        <div class="invalid-feedback">Image is required.</div>
        <img
          id="imagePreview"
          src=""
          alt="Image preview"
          class="img-fluid mt-3 rounded d-none"
          style="max-height: 250px;"
        />
      </div>

      <button type="submit" class="btn btn-primary w-100">Save Listing</button>
      <div id="formMessage" class="mt-3 text-center text-success"></div>
      <div id="formError" class="mt-3 text-center text-danger"></div>
    </form>
  </main>

  <footer class="bg-dark text-light py-4 mt-auto">
    <div class="container text-center small">
      &copy; 2024 GadgetStore. All rights reserved.
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="./auth.js"></script>
  <script src="./form.js"></script>
  <script>
    // Redirect to login if not logged in
    document.addEventListener('DOMContentLoaded', () => {
      auth.renderNavbar();
      if (!auth.isLoggedIn()) {
        window.location.href = "login.html";
        return;
      }
    });
  </script>
</body>
</html>
